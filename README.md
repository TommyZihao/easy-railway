# 钢轨表面伤损细粒度图像识别应用—小轨当家

> 2021-01-31

[TOC]

![image-20210131214146005](【用户手册】钢轨表面伤损细粒度图像识别应用—小轨当家.assets/image-20210131214146005.png)



# 功能概述

基于YOLOV5的钢轨表面伤损图像识别目标检测人工智能算法的用户图形界面。

用户在软件中指定待测图像、模型权重文件、后处理超参数等，软件运行算法模型并展示结果。

中文文档：https://github.com/TommyZihao/easy-railway

# 软件界面

![image-20210131220408628](【用户手册】钢轨表面伤损细粒度图像识别应用—小轨当家.assets/image-20210131220408628.png)

![image-20210131220504894](【用户手册】钢轨表面伤损细粒度图像识别应用—小轨当家.assets/image-20210131220504894.png)

# 技术背景

张子豪硕士毕业论文 《钢轨表面伤损细粒度图像分类与检测系统》采集并标注了高速铁路、重载铁路、城市轨道交通等不同工况下1100张钢轨表面伤损图片，形成大规模细粒度目标检测数据集。训练了基于YOLOV5的人工智能图像识别算法模型。在精准识别13类轨面信息的基础上，定量计算出裂纹面积、光带偏心、光带异常、剥离掉块个数及大小、波浪形磨耗波长等细粒度钢轨表面伤损评价指标，同时得到关于经纬度、轨面、光带、焊缝、扣件、道钉螺栓、紧固螺栓、轨距角、打磨、铣磨等细粒度信息。

针对类别数量不均衡、小目标、密目标、黑暗背景、轨面反光、大片连续、局部遮挡、框内有框、聚焦模糊、横竖屏共存、窄长条类别多、难例易混例多等不同问题进行特征工程和算法调参优化。使用遗传算法、神经架构搜索（NAS）等自动机器学习（Auto ML）进行超参数搜索优化。对算法模型压缩加速等轻量化处理，通过软硬件一体化的嵌入式开发，部署为终端实时检测的边缘计算设备。最终实现轨道交通钢轨表面养护维修的全息数据采集、自动辅助标注、智能实时识别、海量数据挖掘、终端地图展示、AI辅助决策、精准健康评估。

# 识别结果类别与框颜色一览表

| 类别代号 | 中文名称               | 识别结果框颜色 |
| -------- | ---------------------- | -------------- |
| RW       | 轨面                   | 天青色         |
| GD       | 光带                   | 天蓝色         |
| GD2      | 暗光带（轨距角）       | 深蓝色         |
| DK       | 剥离掉块               | 嫣红色         |
| LW       | 裂纹                   | 金黄色         |
| BM       | 波浪形磨耗（短波波磨） | 木槿紫色       |
| DM       | 打磨痕迹               | 棕褐色         |
| KJ       | 扣件弹条               | 嫩绿色         |
| LSA      | 扣件中心道钉螺栓       | 深绿色         |
| LSB      | 扣件外围紧固螺栓       | 桔橙色         |
| DK2      | 圆形硌伤               | 桔橙色         |
| CS       | 擦伤                   | 橙色           |
| HF       | 焊缝                   | 桃粉色         |

# 操作说明

兼容编程语言：Python 3.7.2

兼容操作系统：Windows 7、Windows 10、MacOS、Ubuntu

## 配置环境

安装Python3.7.2编程环境，并将pip镜像源切换至中国国内镜像站，例如清华大学开源软件镜像站。

下载并解压`0123-yolov5.zip`压缩包，得到`0123-yolov5`文件夹，在命令行中切换目录至这个文件夹。

在命令行中运行`pip3 install -r requirements.txt`，安装配置Python第三方工具包。

## 使用软件

在命令行中运行`python3 GUI-APP.py`，打开软件用户图形界面。

用户通过点选和勾选指定算法预测和后处理超参数：输出文件夹名称、模型权重文件路径、待测图片文件路径、conf-thres阈值、NMS-IOU阈值、输入算法图像大小img-size、是否TTA图像增强、是否NMS不同类型相互影响、是否仅显示裂纹和光带、是否调用摄像头进行实时识别。

按下键盘上的`a`键，启动预测，等待五秒左右。

如果勾选了调用摄像头进行实时识别，按下键盘上的`a`键之后会启动摄像头预测，按`Esc`键退出。

预测结果显示在图形界面上，预测结果原图保存在`conf-iou-test`目录下。

点击`Cancel`按钮，或按键盘上的`q`键，或点击`x`按钮，退出软件。

## 最佳实践

将模型权重文件保存在`weights`目录下。

将待测图片文件保存在`assets/images`目录下。

预测结果原图保存在`conf-iou-test`目录下。

# 技术支持及合作伙伴

YOLOV5目标检测算法：https://github.com/ultralytics/yolov5

华为云EI企业智能一站式AI开发平台ModelArts：https://console.huaweicloud.com/modelarts

TensorFlow Object Detection API：https://github.com/tensorflow/models/tree/master/research/object_detection

AI云算力平台Featurize：https://featurize.cn/

# 开发团队

同济大学交通运输工程学院 城市轨道与铁道工程系 轨道结构管理课题组

商业合作：数据采集、数据标注、数据挖掘、算法模型、小程序开发、边缘计算、轨道交通智能运维、线路细粒度评估

联系方式：

张子豪 同济大学交通运输工程学院2018级研究生

[407431120@qq.com](mailto:407431120@qq.com)

周宇 同济大学交通运输工程学院副教授

[wqhuo2785@163.com](mailto:wqhuo2785@163.com)
